openapi: 3.0.3
info:
  title: Net-Ninja Local API
  version: 1.0.0
servers:
  - url: http://127.0.0.1:8787
paths:
  /api/v1/system/info:
    get:
      summary: System info
      responses:
        '200': { description: OK }

  # Discovery (network scan)
  /api/v1/discovery/preconditions:
    get:
      summary: Scan preconditions (readiness)
      responses:
        '200': { description: OK }
  /api/v1/discovery/scan:
    post:
      summary: Start scan
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                subnet: { type: string, nullable: true }
                timeoutMs: { type: integer, nullable: true }
      responses:
        '200': { description: Scan results }
  /api/v1/discovery/results:
    get:
      summary: Scan results
      responses:
        '200': { description: Device list }
  /api/v1/discovery/progress:
    get:
      summary: Scan progress
      responses:
        '200': { description: OK }
  /api/v1/discovery/stop:
    post:
      summary: Stop active scan
      responses:
        '200': { description: OK }

  # Speedtest
  /api/v1/speedtest/servers:
    get:
      summary: Available speedtest server profiles
      responses:
        '200': { description: OK }
  /api/v1/speedtest/config:
    get:
      summary: Speedtest config
      responses:
        '200': { description: OK }
    post:
      summary: Update speedtest config
      responses:
        '200': { description: OK }
  /api/v1/speedtest/start:
    post:
      summary: Mark speedtest run active
      responses:
        '200': { description: OK }
  /api/v1/speedtest/abort:
    post:
      summary: Abort active speedtest run
      responses:
        '200': { description: OK }
  /api/v1/speedtest/reset:
    post:
      summary: Reset speedtest state
      responses:
        '200': { description: OK }
  /api/v1/speedtest/live:
    get:
      summary: Read live speedtest state
      responses:
        '200': { description: OK }
  /api/v1/speedtest/result:
    post:
      summary: Publish speedtest results to backend state
      responses:
        '200': { description: OK }
  /api/v1/speedtest/ping:
    get:
      summary: Ping probe for speedtest
      responses:
        '200': { description: OK }
  /api/v1/speedtest/download:
    get:
      summary: Streaming payload for download measurement
      responses:
        '200': { description: binary stream }
  /api/v1/speedtest/upload:
    post:
      summary: Upload sink for upload measurement
      responses:
        '200': { description: OK }

  # Cameras
  /api/v1/onvif/discover:
    get:
      summary: Discover ONVIF cameras
      responses:
        '200': { description: OK }

  # Devices
  /api/v1/devices/{id}:
    get:
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Device }
  /api/v1/devices/{id}/meta:
    get:
      summary: Device metadata
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: OK }
    put:
      summary: Update device metadata
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200': { description: OK }
  /api/v1/devices/{id}/history:
    get:
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Device history }
  /api/v1/devices/{id}/uptime:
    get:
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string }
      responses:
        '200': { description: Uptime }
  /api/v1/export/devices:
    get:
      summary: Export devices
      responses:
        '200': { description: Export }

  # Metrics + logs
  /api/v1/metrics:
    get:
      summary: Server metrics
      responses:
        '200': { description: OK }
  /api/v1/logs/stream:
    get:
      summary: SSE log stream
      responses:
        '200': { description: Stream }

  # OpenClaw gateway (HTTP). WebSocket `/openclaw/ws` is documented separately.
  /api/openclaw/nodes:
    get:
      summary: OpenClaw nodes (connected clients)
      responses:
        '200': { description: OK }
  /api/openclaw/stats:
    get:
      summary: OpenClaw gateway stats
      responses:
        '200': { description: OK }
