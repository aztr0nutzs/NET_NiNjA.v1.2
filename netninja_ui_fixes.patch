*** Begin Patch
*** Update File: web-ui/state.js
@@ export async function runScan(subnet) {
-  const devices = await api("/api/v1/discovery/results");
+  // unwrap the result from api() – it returns { ok, status, data }
+  const devicesRes = await api("/api/v1/discovery/results");
+  const devices = devicesRes?.data || [];
@@ export async function runScan(subnet) {
-           const hist = await api(`/api/v1/devices/${encodeURIComponent(d.id)}/history`);
-           const up = await api(`/api/v1/devices/${encodeURIComponent(d.id)}/uptime`);
+           // unwrap history and uptime responses from api()
+           const histRes = await api(`/api/v1/devices/${encodeURIComponent(d.id)}/history`);
+           const hist = histRes?.data || [];
+           const upRes = await api(`/api/v1/devices/${encodeURIComponent(d.id)}/uptime`);
+           const up = upRes?.data || {};
*** End Patch

*** Update File: android-app/src/main/assets/web-ui/state.js
@@ export async function runScan(subnet) {
-  const devices = await api("/api/v1/discovery/results");
+  // unwrap the result from api() – it returns { ok, status, data }
+  const devicesRes = await api("/api/v1/discovery/results");
+  const devices = devicesRes?.data || [];
@@ export async function runScan(subnet) {
-           const hist = await api(`/api/v1/devices/${encodeURIComponent(d.id)}/history`);
-           const up = await api(`/api/v1/devices/${encodeURIComponent(d.id)}/uptime`);
+           // unwrap history and uptime responses from api()
+           const histRes = await api(`/api/v1/devices/${encodeURIComponent(d.id)}/history`);
+           const hist = histRes?.data || [];
+           const upRes = await api(`/api/v1/devices/${encodeURIComponent(d.id)}/uptime`);
+           const up = upRes?.data || {};
*** End Patch

*** Update File: web-ui/ninja_mobile.html
@@ function deriveMeta(device) {
-       const ip = device.ip || device.id || "";
-       const parts = ip.split(".");
-       const lastOctet = parseInt(parts[3] || "0", 10);
-       const osList = ["WINDOWS", "LINUX", "ANDROID"];
-       const tagList = ["IOT", "SERVER", "WORKSTATION"];
-       return {
-         name: device.hostname || device.id || ip || "Unknown",
-         os: device.os || osList[lastOctet % osList.length],
-         tag: device.vendor || tagList[lastOctet % tagList.length]
-       };
+       // Use actual fields from the backend and avoid random OS/tag assignments
+       return {
+         name: device.name || device.hostname || device.id || device.ip || "Unknown",
+         os: device.os || "Unknown",
+         tag: device.vendor || device.tag || "Unknown"
+       };
*** End Patch

*** Update File: android-app/src/main/assets/web-ui/ninja_mobile.html
@@ function deriveMeta(device) {
-       const ip = device.ip || device.id || "";
-       const parts = ip.split(".");
-       const lastOctet = parseInt(parts[3] || "0", 10);
-       const osList = ["WINDOWS", "LINUX", "ANDROID"];
-       const tagList = ["IOT", "SERVER", "WORKSTATION"];
-       return {
-         name: device.hostname || device.id || ip || "Unknown",
-         os: device.os || osList[lastOctet % osList.length],
-         tag: device.vendor || tagList[lastOctet % tagList.length]
-       };
+       // Use actual fields from the backend and avoid random OS/tag assignments
+       return {
+         name: device.name || device.hostname || device.id || device.ip || "Unknown",
+         os: device.os || "Unknown",
+         tag: device.vendor || device.tag || "Unknown"
+       };
*** End Patch

*** Update File: web-ui/new_assets/ninja_mobile.html
@@ function deriveMeta(device) {
-       const ip = device.ip || device.id || "";
-       const parts = ip.split(".");
-       const lastOctet = parseInt(parts[3] || "0", 10);
-       const osList = ["WINDOWS", "LINUX", "ANDROID"];
-       const tagList = ["IOT", "SERVER", "WORKSTATION"];
-       return {
-         name: device.hostname || device.id || ip || "Unknown",
-         os: device.os || osList[lastOctet % osList.length],
-         tag: device.vendor || tagList[lastOctet % tagList.length]
-       };
+       // Use actual fields from the backend and avoid random OS/tag assignments
+       return {
+         name: device.name || device.hostname || device.id || device.ip || "Unknown",
+         os: device.os || "Unknown",
+         tag: device.vendor || device.tag || "Unknown"
+       };
*** End Patch

*** Update File: android-app/src/main/assets/web-ui/new_assets/ninja_mobile.html
@@ function deriveMeta(device) {
-       const ip = device.ip || device.id || "";
-       const parts = ip.split(".");
-       const lastOctet = parseInt(parts[3] || "0", 10);
-       const osList = ["WINDOWS", "LINUX", "ANDROID"];
-       const tagList = ["IOT", "SERVER", "WORKSTATION"];
-       return {
-         name: device.hostname || device.id || ip || "Unknown",
-         os: device.os || osList[lastOctet % osList.length],
-         tag: device.vendor || tagList[lastOctet % tagList.length]
-       };
+       // Use actual fields from the backend and avoid random OS/tag assignments
+       return {
+         name: device.name || device.hostname || device.id || device.ip || "Unknown",
+         os: device.os || "Unknown",
+         tag: device.vendor || device.tag || "Unknown"
+       };
*** End Patch
*** End Patch
